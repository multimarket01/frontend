import './polyfills.server.mjs';
import{f as y,j as T,q as C}from"./chunk-3WANE6QX.mjs";import{e as w}from"./chunk-REDQX6TU.mjs";import{d as b}from"./chunk-LDFFNCZY.mjs";import{Dd as f,Ic as l,N as g,Pd as S,Q as a,R as e,Zc as d,_c as u,bd as _,da as p,hd as O,ka as c,q as m,ud as i}from"./chunk-JAGZ7S7U.mjs";import{a as o,b as n}from"./chunk-S6KH3LOX.mjs";var H=(()=>{class r{constructor(t,s,I,$,v){this.meta=t,this.router=s,this.titleService=I,this.platformId=$,this.ngZone=v,this.setting$=e(i).select(f.setting),this.themeOption$=e(i).select(b.themeOptions),this.product$=e(i).select(S.selectedProduct),this.blog$=e(i).select(y.selectedBlog),this.brand$=e(i).select(T.selectedBrand),this.page$=e(i).select(w.selectedPage),this.category$=e(i).select(C.selectedCategory),this.currentMessageIndex=0,this.delay=1e3,this.isTabInFocus=!0,this.scoContent={},this.isBrowser=l(this.platformId),this.isBrowser&&(this.router.events.pipe(m(h=>h instanceof _)).subscribe(h=>{this.path=h.url,document.addEventListener("visibilitychange",()=>{this.messages=this.themeOption.general.taglines,this.ngZone.run(()=>{this.updateSeo(this.path)})}),this.updateSeo(this.path)}),this.fetchData())}fetchData(){this.setting$.subscribe(t=>this.setting=t),this.product$.subscribe(t=>this.product=t),this.blog$.subscribe(t=>this.blog=t),this.page$.subscribe(t=>this.page=t),this.brand$.subscribe(t=>this.brand=t),this.category$.subscribe(t=>this.category=t),this.themeOption$.subscribe(t=>{this.themeOption=t})}updateSeo(t){t.includes("product")?(this.product&&(this.scoContent={url:window.location.href,og_title:this.product.meta_title||this.themeOption?.seo?.meta_title,og_description:this.product.meta_description||this.themeOption?.seo?.meta_description,og_image:this.product.product_meta_image?.original_url||this.themeOption?.seo?.og_image?.original_url}),this.customSCO()):t.includes("blog")?this.blog&&(this.scoContent=n(o({},this.scoContent),{url:window.location.href,og_title:this.blog?.meta_title||this.themeOption?.seo?.meta_title,og_description:this.blog?.meta_description||this.themeOption?.seo?.meta_description,og_image:this.blog?.blog_meta_image?.original_url||this.themeOption?.seo?.og_image?.original_url}),this.customSCO()):t.includes("page")?(this.page&&(this.scoContent=n(o({},this.scoContent),{url:window.location.href,og_title:this.page?.meta_title||this.themeOption?.seo?.meta_title,og_description:this.page?.meta_description||this.themeOption?.seo?.meta_description,og_image:this.page?.page_meta_image?.original_url||this.themeOption?.seo?.og_image?.original_url})),this.customSCO()):t.includes("brand")?(this.brand&&(this.scoContent=n(o({},this.scoContent),{url:window.location.href,og_title:this.brand?.meta_title||this.themeOption?.seo?.meta_title,og_description:this.brand?.meta_description||this.themeOption?.seo?.meta_description,og_image:this.brand?.brand_meta_image?.original_url||this.themeOption?.seo?.og_image?.original_url})),this.customSCO()):t.includes("category")?(this.category&&(this.scoContent=n(o({},this.scoContent),{url:window.location.href,og_title:this.category?.meta_title||this.themeOption?.seo?.meta_title,og_description:this.category?.meta_description||this.themeOption?.seo?.meta_description,og_image:this.category?.category_meta_image?.original_url||this.themeOption?.seo?.og_image?.original_url})),this.customSCO()):this.updateDefaultSeo()}updateDefaultSeo(){if(this.meta.updateTag({name:"title",content:this.themeOption?.seo?.meta_title}),this.meta.updateTag({name:"description",content:this.themeOption?.seo?.meta_description}),this.meta.updateTag({property:"og:type",content:"website"}),this.meta.updateTag({property:"og:url",content:this.scoContent.url}),this.meta.updateTag({property:"og:title",content:this.themeOption?.seo?.meta_title}),this.meta.updateTag({property:"og:description",content:this.themeOption?.seo?.meta_description}),this.meta.updateTag({property:"og:image",content:this.scoContent.og_image}),this.meta.updateTag({property:"twitter:card",content:"summary_large_image"}),this.meta.updateTag({property:"twitter:url",content:this.scoContent.url}),this.meta.updateTag({property:"twitter:title",content:this.themeOption?.seo?.meta_title}),this.meta.updateTag({property:"twitter:description",content:this.themeOption?.seo?.meta_description}),this.meta.updateTag({property:"twitter:image",content:this.scoContent.og_image}),this.themeOption?.general&&this.themeOption?.general?.exit_tagline_enable)document.addEventListener("visibilitychange",()=>{this.messages=this.themeOption.general.taglines,this.ngZone.run(()=>{if(this.isTabInFocus=!document.hidden,this.isTabInFocus)return clearTimeout(this.timeoutId),this.titleService.setTitle(this.themeOption?.general?.site_title&&this.themeOption?.general?.site_tagline?`${this.themeOption?.general?.site_title} | ${this.themeOption?.general?.site_tagline}`:"");this.updateMessage()})}),this.scoContent=n(o({},this.scoContent),{url:window.location.href,og_title:this.themeOption?.seo?.meta_title,og_description:this.themeOption?.seo?.meta_description,og_image:this.themeOption?.seo?.og_image?.original_url}),this.customSCO();else return this.titleService.setTitle(this.themeOption?.general?.site_title&&this.themeOption?.general?.site_tagline?`${this.themeOption?.general?.site_title} | ${this.themeOption?.general?.site_tagline}`:"")}customSCO(){let t=this.scoContent.og_title,s=this.scoContent.og_description;this.titleService.setTitle(t),this.meta.updateTag({name:"title",content:t}),this.meta.updateTag({name:"description",content:s}),this.meta.updateTag({property:"og:type",content:"website"}),this.meta.updateTag({property:"og:url",content:this.scoContent.url}),this.meta.updateTag({property:"og:title",content:t}),this.meta.updateTag({property:"og:description",content:s}),this.meta.updateTag({property:"og:image",content:this.scoContent.og_image}),this.meta.updateTag({property:"twitter:card",content:"summary_large_image"}),this.meta.updateTag({property:"twitter:url",content:this.scoContent.url}),this.meta.updateTag({property:"twitter:title",content:t}),this.meta.updateTag({property:"twitter:description",content:s}),this.meta.updateTag({property:"twitter:image",content:this.scoContent.og_image})}updateMessage(){clearTimeout(this.timeoutId),this.currentMessage=this.messages[this.currentMessageIndex],this.titleService.setTitle(this.currentMessage),this.currentMessageIndex=(this.currentMessageIndex+1)%this.messages.length,this.timeoutId=setTimeout(()=>{this.updateMessage()},this.delay)}ngOnDestroy(){clearTimeout(this.timeoutId)}static{this.\u0275fac=function(s){return new(s||r)(a(d),a(O),a(u),a(c),a(p))}}static{this.\u0275prov=g({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();export{H as a};
